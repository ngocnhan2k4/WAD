<!-- product-detail -->
{{#if product}}
<div class="container grid grid-cols-2 gap-6 mt-10 detail-box">
    <div>
        <img src={{product.Images.[0].directory_path}} alt="product" class="w-full">
        <div class="grid grid-cols-5 gap-4 mt-4">
            
            {{#each product.Images}}
            {{#if (eq @index 0)}}
            <img src="{{directory_path}}" alt="product" class="object-contain w-full h-full border cursor-pointer border-primary">
            {{else}}
            <img src="{{directory_path}}" alt="product" class="object-contain w-full h-full border cursor-pointer">
            {{/if}}
            {{/each}}
        </div>
    </div>

    <div>
        <h2 class="mb-2 text-3xl font-medium uppercase product-detail-name">{{product.product_name}}</h2>
        <div class="space-y-2">
            <p class="space-x-2 font-semibold text-gray-800">
                <span>Availability: </span>
                <span class="text-green-600">{{availability}}</span>
            </p>
            <p class="space-x-2">
                <span class="font-semibold text-gray-800">Brand: </span>
                <span class="text-gray-600">{{product.Suppliers.brand}}</span>
            </p>
            <p class="space-x-2">
                <span class="font-semibold text-gray-800">Category: </span>
                <span class="text-gray-600">{{product.Categories.category_name}}</span>
            </p>
            
        </div>
        <div class="flex items-baseline mt-4 mb-1 space-x-2 font-roboto">
            <p class="text-xl font-semibold text-primary">${{product.current_price}}</p>
            <p class="text-base text-gray-400 line-through">${{product.original_price}}</p>
        </div>

        <p class="mt-4 text-gray-600">{{product.description}}</p>

        <div class="pt-4">
            <h3 class="mb-1 text-sm text-gray-800 uppercase">Size</h3>
            <div class="flex items-center gap-2">
                <div class="size-selector">
                    <input type="radio" name="size" id="size-xs" class="hidden">
                    <label for="size-xs"
                        class="flex items-center justify-center w-6 h-6 text-xs text-gray-600 border border-gray-200 rounded-sm shadow-sm cursor-pointer">XS</label>
                </div>
                <div class="size-selector">
                    <input type="radio" name="size" id="size-sm" class="hidden">
                    <label for="size-sm"
                        class="flex items-center justify-center w-6 h-6 text-xs text-gray-600 border border-gray-200 rounded-sm shadow-sm cursor-pointer">S</label>
                </div>
                <div class="size-selector">
                    <input type="radio" name="size" id="size-m" class="hidden">
                    <label for="size-m"
                        class="flex items-center justify-center w-6 h-6 text-xs text-gray-600 border border-gray-200 rounded-sm shadow-sm cursor-pointer">M</label>
                </div>
                <div class="size-selector">
                    <input type="radio" name="size" id="size-l" class="hidden">
                    <label for="size-l"
                        class="flex items-center justify-center w-6 h-6 text-xs text-gray-600 border border-gray-200 rounded-sm shadow-sm cursor-pointer">L</label>
                </div>
                <div class="size-selector">
                    <input type="radio" name="size" id="size-xl" class="hidden">
                    <label for="size-xl"
                        class="flex items-center justify-center w-6 h-6 text-xs text-gray-600 border border-gray-200 rounded-sm shadow-sm cursor-pointer">XL</label>
                </div>
            </div>
        </div>

        <div class="pt-4">
            <h3 class="mb-3 text-xl font-medium text-gray-800 uppercase">Color</h3>
            <div class="flex items-center gap-2">
                <div class="color-selector">
                    <input type="radio" name="color" id="red" class="hidden">
                    <label for="red"
                        class="block w-6 h-6 border border-gray-200 rounded-sm shadow-sm cursor-pointer"
                        style="background-color: #fc3d57;"></label>
                </div>
                <div class="color-selector">
                    <input type="radio" name="color" id="black" class="hidden">
                    <label for="black"
                        class="block w-6 h-6 border border-gray-200 rounded-sm shadow-sm cursor-pointer"
                        style="background-color: #000;"></label>
                </div>
                <div class="color-selector">
                    <input type="radio" name="color" id="white" class="hidden">
                    <label for="white"
                        class="block w-6 h-6 border border-gray-200 rounded-sm shadow-sm cursor-pointer"
                        style="background-color: #fff;"></label>
                </div>

            </div>
        </div>

        <div class="mt-4">
            <h3 class="mb-1 text-sm text-gray-800 uppercase">Quantity</h3>
            <div class="flex text-gray-600 border border-gray-300 divide-x divide-gray-300 w-max">
                <div class="flex items-center justify-center w-8 h-8 text-xl cursor-pointer select-none">-</div>
                <div class="flex items-center justify-center w-8 h-8 text-base">4</div>
                <div class="flex items-center justify-center w-8 h-8 text-xl cursor-pointer select-none">+</div>
            </div>
        </div>

        <div class="flex gap-3 pt-5 pb-5 mt-6 border-b border-gray-200 button-area">
            
            <button id="add-to-cart-{{product.product_id}}" 
                    data-product-id="{{product.product_id}}" 
                    class="flex items-center gap-2 px-8 py-2 font-medium text-white uppercase transition border rounded add-to-cart-detail bg-primary border-primary hover:bg-transparent hover:text-primary">
                <i class="fa-solid fa-bag-shopping add-to-cart"></i> Add to cart
            </button>
            <a href="#"
                class="flex items-center gap-2 px-8 py-2 font-medium text-gray-600 uppercase transition border border-gray-300 rounded hover:text-primary wishlist-detail">
                <i class="fa-solid fa-heart wishlist-icon"></i> Wishlist
            </a>
        </div>

        <div class="flex gap-3 mt-4">
            <a href="#"
                class="flex items-center justify-center w-8 h-8 text-gray-400 border border-gray-300 rounded-full hover:text-gray-500">
                <i class="fa-brands fa-facebook-f"></i>
            </a>
            <a href="#"
                class="flex items-center justify-center w-8 h-8 text-gray-400 border border-gray-300 rounded-full hover:text-gray-500">
                <i class="fa-brands fa-twitter"></i>
            </a>
            <a href="#"
                class="flex items-center justify-center w-8 h-8 text-gray-400 border border-gray-300 rounded-full hover:text-gray-500">
                <i class="fa-brands fa-instagram"></i>
            </a>
        </div>
    </div>
</div>
{{/if}}
<!-- ./product-detail -->
<!-- reviews -->
<div class="container pb-16">
    
    <!-- Add a review -->
    <div class="p-6 mt-6 mb-6 bg-white rounded-lg shadow">
        <h4 class="mb-4 text-lg font-semibold text-gray-800">Add a Review</h4>
        <form id="review-form" class="space-y-4">
            <input type="hidden" id="user-id" value="{{user.id}}"> 
            <input type="hidden" id="product-id" value="{{product.product_id}}">

            <!-- Textarea for review -->
            <div>
                <label for="review-detail" class="block mb-2 text-sm font-medium text-gray-700">
                    Your Comment
                </label>
                <textarea id="review-detail" name="review_detail" rows="3"
                    class="w-full p-3 text-gray-800 border rounded-lg focus:ring-primary focus:border-primary"
                    placeholder="Write your comment here..."required></textarea>
            </div>

            <!-- Submit Button -->
            <div class="flex justify-end">
                <button id="submit-btn" type="submit"
                    class="px-4 py-2 text-white transition bg-blue-500 rounded hover:bg-blue-600">
                    Submit
                </button>
            </div>
        </form>
    </div>
    
    <h3 class="pb-3 mb-6 text-2xl font-medium text-gray-800 border-b border-gray-200 font-roboto">Reviews</h3>
    <input type="hidden" id="product-id" value="{{product.product_id}}">

    <div id="reviews-container" class="space-y-6">
        {{#each reviews}}
            <div class="p-4 bg-white rounded-lg shadow review">
                <div class="flex items-center mb-3">
                    <span class="text-sm font-semibold text-gray-700">{{this.User.fullName}}</span> <!-- Hiển thị tên đầy đủ người bình luận -->
                    <span class="ml-2 text-sm text-gray-500">{{this.creation_time}}</span>
                </div>
                <div class="text-gray-800 review-detail">
                    {{this.review_detail}}
                </div>
            </div>
        {{else}}
            <p class="text-center text-gray-500">No reviews available.</p>
        {{/each}}
    </div>
    
    <div id="pagination-container" class="flex items-center justify-center mt-6 space-x-2">
    <span class="text-gray-700">Page {{pagination.currentPage}} of {{pagination.totalPages}}</span>

    <!-- Display the "Previous" button -->
    {{#if pagination.hasPreviousPage}}
        <button onclick="loadReviews({{pagination.previousPage}})" class="px-4 py-2 text-white transition bg-blue-500 rounded hover:bg-blue-600">Previous</button>
    {{/if}}

    <!-- Display the page numbers -->
    <div class="flex space-x-2">
        {{#each pagination.pages}}
            <button onclick="loadReviews({{this}})" class="px-3 py-2 text-gray-700 transition bg-gray-200 rounded hover:bg-gray-300 {{#ifCond this pagination.currentPage}}bg-blue-500 text-white{{/ifCond}}">
                {{this}}
            </button>
        {{/each}}
    </div>

    <!-- Display the "Next" button -->
    {{#if pagination.hasNextPage}}
        <button onclick="loadReviews({{pagination.nextPage}})" class="px-4 py-2 text-white transition bg-blue-500 rounded hover:bg-blue-600">Next</button>
    {{/if}}
</div>

</div>
<!-- ./reviews -->
<!-- related product -->
<div class="container pb-16">
    <h2 class="mb-6 text-2xl font-medium text-gray-800 uppercase">Related products</h2>
    <div class="grid max-w-full grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4">
        {{#each relatedProducts}}
        <div class="bg-white rounded shadow group">
            <div class="relative">
                <a href="/product/productDetail?id={{this.product_id}}"><img src={{this.Images.[0].directory_path}} alt="product{{@index}}" class="w-full"></a>
            </div>
            <div class="px-4 pt-4 pb-3">
                <a href="/product/productDetail?id={{this.product_id}}">
                    <h4 class="mb-2 text-xl font-medium text-gray-800 uppercase transition hover:text-primary">
                        {{this.product_name}}</h4>
                </a>
                <div class="flex items-baseline mb-1 space-x-2">
                    <p class="text-xl font-semibold text-primary">${{this.current_price}}</p>
                    <p class="text-sm text-gray-400 line-through">${{this.original_price}}</p>
                </div>
            </div>
            <button id="add-to-cart-{{this.product_id}}" 
                    data-product-id="{{this.product_id}}" 
                    class="block w-full py-1 text-center text-white transition border rounded-b add-to-cart bg-primary border-primary hover:bg-transparent hover:text-primary">
                Add to cart
            </button>
        </div>
        {{/each}}
    </div>
</div>
<!-- ./related product -->
<script src="/js/reviews.js"></script>
<script type="module" src="/js/addCart.js"></script>